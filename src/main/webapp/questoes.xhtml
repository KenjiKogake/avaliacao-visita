<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

<ui:composition template="_template.xhtml">
	<ui:define name="titulo">
	</ui:define>
	<ui:define name="conteudo">
	<p:commandButton value="Novo" onclick="PF('questaoDialog').show()"/>
	
	<h:form id="formFiltro">
		<h:panelGrid columns="1">
			<p:inputText placeholder="Filtro por Questao" value="#{questaoBean.filtroQuestao.questao}"
				required="false">
				<p:ajax update="formLista:table"/>
			</p:inputText>
			
			<p:selectOneMenu id="tipo" value="#{questaoBean.filtroQuestao.tipo}" converter="entityConverter">
				<p:ajax listener="#{questaoBean.aplicaFiltroOneMenu}" event="change" update="formLista:table"/>
				<f:selectItem itemLabel="Filtro por Tipo de Questão" itemValue="#{null}"/>
				<f:selectItems value="#{questaoBean.tiposQuestao}" var="t" itemLabel="#{t.tipo}" itemValue="#{t}"/>
			</p:selectOneMenu>
		</h:panelGrid>
		<p:commandButton action="#{questaoBean.atualizaTabela}" value="Filtrar" update="formLista"/>
	</h:form>
	<h:form id="formLista">
	
		<p:dataTable id="table" value="#{questaoBean.model}" var="q" lazy="true" rows="5"
			paginator="true" selectionMode="single" rowKey="#{q.id}" rowsPerPageTemplate="10, 20, 30">
			
			<p:ajax event="rowSelect" listener="#{questaoBean.onRowSelect}" oncomplete="PF('questaoDialog').show()" update="form"/>
			
			<p:column headerText="Id" sortBy="#{q.id}" filterBy="#{q.id}">
				<h:outputText value="#{q.id}"/>
			</p:column>
			<p:column headerText="Questão" sortBy="#{q.questao}">
				<h:outputText value="#{q.questao}"/>
			</p:column>
			<p:column headerText="Tipo de Questão" sortBy="#{q.tipo}">
				<h:outputText value="#{q.tipo.tipo}"/>
			</p:column>
		</p:dataTable>
	</h:form>
	
	<p:dialog header="Cadastro de Questão" widgetVar="questaoDialog" resizable="false" 
		modal="true" draggable="false" closeOnEscape="true" dynamic="true">
		<h:form id="form">
			<h:inputHidden id="id" value="#{questaoBean.questao.id}"/>
			<h:panelGrid columns="2" id="questaoPanelGrid">
			
				<h:outputLabel for="questao" value="Questão"/>
				<p:inputText id="questao" value="#{questaoBean.questao.questao}"/>
				
				<h:outputLabel for="tipo" value="Tipo de Questão"/>
				<p:selectOneMenu id="tipo" value="#{questaoBean.questao.tipo}" converter="entityConverter">
					<f:selectItems value="#{questaoBean.tiposQuestao}" var="t" itemLabel="#{t.tipo}"/>
				</p:selectOneMenu>
				
				<p:commandButton value="Gravar" actionListener="#{questaoBean.salvar}" update=":form :formLista"
					process="@form" oncomplete="PF('questaoDialog').hide()" icon="ui-icon-check"/>
			</h:panelGrid>
		</h:form>
	</p:dialog>
	
	</ui:define>
</ui:composition>
</html>